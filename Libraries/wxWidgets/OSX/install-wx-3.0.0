#!/bin/sh

echo "Getting wxWidgets 3.0.0 source..."

rm -rf Source

git clone -b WX_3_0_0 --single-branch https://github.com/wxWidgets/wxWidgets.git Source


echo "Configuring the debug library..."
rm -rf Debug
mkdir Debug
cd Debug
../Source/configure --with-osx_cocoa --disable-shared --with-macosx-version-min=10.9 --with-macosx-sdk=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk --without-libtiff --with-zlib=builtin --with-expat=builtin --without-libiconv CXXFLAGS="-stdlib=libc++ -std=c++11" OBJCXXFLAGS="-stdlib=libc++ -std=c++11" CPPFLAGS="-stdlib=libc++" LDFLAGS="-stdlib=libc++" CXX=clang++ CXXCPP="clang++ -E" CC=clang CPP="clang -E" --enable-debug

echo "Building the debug library..."
make

cd ..

echo "Configuring the release library..."

rm -rf Release
mkdir Release
cd Release
../Source/configure --with-osx_cocoa --disable-shared --with-macosx-version-min=10.9 --with-macosx-sdk=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk --without-libtiff --with-zlib=builtin --with-expat=builtin --without-libiconv CXXFLAGS="-stdlib=libc++ -std=c++11" OBJCXXFLAGS="-stdlib=libc++ -std=c++11" CPPFLAGS="-stdlib=libc++" LDFLAGS="-stdlib=libc++" CXX=clang++ CXXCPP="clang++ -E" CC=clang CPP="clang -E"

echo "Building the release library..."
make

cd ..

echo "Creating the Xcode config files..."

XCCONFIG_FILE_RELEASE="wx-3.0-release.xcconfig"
XCCONFIG_FILE_DEBUG="wx-3.0-debug.xcconfig"

echo "// Configuration file for wxWidgets, automatically generated by the install script." > $XCCONFIG_FILE_RELEASE

printf "OTHER_CPLUSPLUSFLAGS = " >> $XCCONFIG_FILE_RELEASE
Release/wx-config --cxxflags >> $XCCONFIG_FILE_RELEASE

printf "OTHER_LDFLAGS = " >> $XCCONFIG_FILE_RELEASE
Release/wx-config --libs >> $XCCONFIG_FILE_RELEASE


echo "// Configuration file for wxWidgets, automatically generated by the install script." > $XCCONFIG_FILE_DEBUG

printf "OTHER_CPLUSPLUSFLAGS = " >> $XCCONFIG_FILE_DEBUG
Debug/wx-config --cxxflags >> $XCCONFIG_FILE_DEBUG

printf "OTHER_LDFLAGS = " >> $XCCONFIG_FILE_DEBUG
Debug/wx-config --libs >> $XCCONFIG_FILE_DEBUG